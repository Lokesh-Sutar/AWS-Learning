# EC2 - Elastic Compute Cloud
Allow us to create own virtual server/machine also known as EC2 Instance, mainly usedd for deployments

## Tag
- it is just a label use to segregate instance

## Types of EC2 Instances
1. General Purpose Instance
    - Systems have all the **equivalent** resources such as 
        - Compute (CPU)
        - Storage
        - Memomry
        - Networking
    - There are many Instances types
        - T3 micro
        - T3 small
        - T3 medium, and so on...

2. Compute Optimized Instance
    - designed for CPU-intensive workloads
    - Prioritize CPUs over other resources

3. Memory Optimized Instance
    - Provides high amount of RAM related to CPU resouces
    - High capacity and speed
    - Useful for large databases and caching servers etc
    - eg. R4, R5, X1, etc

4. Storage Optimized Instance
    - Provides high amount of Storage
    - Designed for applications that need a lot of storage space
    - SSD/HDD
    - Useful for backups
    - eg. I3, D2, D3, H1, etc

5. Acceleratd Optimized Instance
    - Specialized instance designed to handle tasks that benefit from accelerated hardware
    - It uses coprocessors or specialized hardware like GPUs
    - Useful for Graphic Processing, Video Processing, Machine Learning, etc
    - eg. F1, G4, P4, etc

## EC2 Instance States
| **Instance State** | **Description**                                                                                                  | **Transition**                                |
|--------------------|------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| **Pending**        | The instance is in the process of being launched. The instance is initializing and is not yet available for use. | From "Pending," it transitions to "Running" when initialization is complete. |
| **Running**        | The instance is fully operational and running. It is available for use, and you can connect to it and perform operations. | From "Running," it can transition to "Stopping," "Hibernating," or "Terminating." |
| **Stopping**       | The instance is in the process of being stopped. It is shutting down but is not yet fully stopped.               | From "Stopping," it transitions to "Stopped" when the shutdown process is complete. |
| **Stopped**        | The instance is stopped and not running. The instance retains its data and configuration, and does not incur charges for instance usage. | From "Stopped," it can transition to "Starting," "Hibernating," or "Terminating." |
| **Starting**       | The instance is in the process of starting up from a stopped state. It is transitioning to the "Running" state. | From "Starting," it transitions to "Running" when it is fully operational. |
| **Shutting-down**  | The instance is in the process of being terminated. It is shutting down and will soon be fully terminated.        | From "Shutting-down," it transitions to "Terminated" when the termination process is complete. |
| **Terminated**     | The instance has been terminated and is permanently removed. It cannot be started again, and all associated resources are released. | Once in "Terminated," the instance cannot transition to any other state. |
| **Hibernating**    | The instance state is saved to EBS, and the instance is stopped. It retains the in-memory data and processes.      | From "Hibernating," it transitions to "Stopped." When restarted, it resumes from the saved state. |

## Key-Pair
- set of security credentials of server.
- Used to securely connect to your EC2 instances without needing to enter a password.
- They help ensure that only authorized users can access your instances.
- Key pair consist of: Public key and Private key

### Types of Key-Pair
1. Public key
2. Private Key (having 2 formats)
    - .ppk -> for Putty application (S1)
    - .pem -> for OpenSSH (making remote connections)

### Types of Encryptions for Key-Pair
1. RSA (Default)
2. ED25519

## Security Group (Firewall)
- It is a security layer which helps to manage incoming and outgoing traffic<br>(allowing specific ports to access throughout the network)
- Has **Inbound** (Incoming requests) and **Outbound** (Outgoing requests) configs

## SSH (Secure Shell)
- It is a protocol used to making a secure connection between 2 devices
- Default port is 22
- [IMP] -> `Allow SSH traffic from` while configuring/launching Instances

## Hosting a website using AWS

### Switch to Root User
```
sudo su
```

### Installation
| **Nginx**                           | **Apache**                            |
| ----------------------------------- | ------------------------------------- |
| `yum install nginx` (RHEL/Amazon)   | `yum install httpd` (RHEL/Amazon)     |
| `apt install nginx` (Debian/Ubuntu) | `apt install apache2` (Debian/Ubuntu)  |
| `yay -S nginx` (Arch)               | `yay -S apache` (Arch)                |

### Version Checking
| **Nginx**  | **Apache**                     |
| ---------- | ------------------------------ |
| `nginx -v` | `apachectl -v` (Debian/Ubuntu) |
|            | `httpd -v` (RHEL/Amazon)       |

### Start Service
| **Nginx**               | **Apache**                                |
| ----------------------- | ----------------------------------------- |
| `systemctl start nginx` | `systemctl start apache2` (Debian/Ubuntu)  |
|                         | `systemctl start httpd` (RHEL/Amazon)     |

### Check Status
| **Nginx**                | **Apache**                                 |
| ------------------------ | ------------------------------------------ |
| `systemctl status nginx` | `systemctl status apache2` (Debian/Ubuntu) |
|                          | `systemctl status httpd` (RHEL/Amazon)     |

### Default Document Root Path for Web Files
| **Nginx**               | **Apache**      |
| ----------------------- | --------------- |
| `/usr/share/nginx/html` | `/var/www/html` |

#### Edit Web Files
| **Nginx**                             | **Apache**                    |
| ------------------------------------- | ----------------------------- |
| `vi /usr/share/nginx/html/index.html` | `vi /var/www/html/index.html` |

### Configuration Directory
| **Nginx**    | **Apache**                     |
| ------------ | ------------------------------ |
| `/etc/nginx` | `/etc/apache2` (Debian/Ubuntu) |
|              | `/etc/httpd` (RHEL/Amazon)     |

#### Edit main config
| **Nginx**                  | **Apache**                      |
| -------------------------- | ------------------------------- |
| `vi /etc/nginx/nginx.conf` | `vi /etc/apache2/apache.conf`  |
|                            | `vi /etc/httpd/conf/httpd.conf` |

## Public IP Explanation
- There are only about 4.3 billion IPv4 addresses available globally.
- Because IPv4 addresses are limited:
    - Public IPs are often dynamically assigned.
    - Your public IP may change after boothing the instance/system.
- To prevent IP changes (especially in cloud environments like AWS), you can use an Elastic IP, which provides:
    - A static public IP address
    - Persistent assignment to your instance

## AMI (Amazon Machine Image)
- AMI is a backup of your ec2 instance, also help to relocate the server
- Contains all the information related to create EC2 Instance and having some preinstalled stuffs like OS, Apps, Application Server.
- You can launch multiple instances from a single AMI when you require multiple instances with the same configuration.
- If we create AMI from the instance, then it contains all the configuration as well as the data.

### Types of AMI (Amazon Machine Image)
1. Amazon Provided AMI: Default Machine Image, Provided by Amazon.
2. Marketplace AMI: Provided by third-party. Required to purchase/take subsciption to access this.
3. Community AMI: Collaboration use, shared in between the group of peoples.
4. Custom AMI: Created by You OR Your Organization.

## Templates
- Used to create new instances with same configurations.
- It is just a blueprint of instance without having any data of that instance.

## Difference Between AMI and Templates
| Feature | AMI (Amazon Machine Image) | Launch Template |
|---|---|---|
| Definition | A preconfigured image used to create EC2 instances | A configuration template that defines how to launch an EC2 instance |
| Purpose | Provides the operating system and installed software | Provides launch settings like instance type, networking, storage, and security |
| Contains OS | Yes | No (but references an AMI) |
| Contains Installed Applications | Yes | No (unless included via User Data or referenced AMI) |
| Includes Instance Configuration | No | Yes |
| Includes Security Groups | No | Yes |
| Includes Instance Type | No | Yes |
| Includes Key Pair | No | Yes |
| Includes User Data Scripts | No | Yes |
| Reusability | Used to create multiple instances with the same software setup | Used to launch instances with consistent configuration settings |
| Versioning | No built-in versioning | Supports versioning |
| Used In Auto Scaling | Indirectly (via Launch Template or Launch Configuration) | Yes, directly used in Auto Scaling Groups |
| Typical Use Case | Create a custom OS image with preinstalled software | Standardize and automate instance launches across environments |
| Relationship | Referenced by Launch Templates | References an AMI |

## Elastic Block Store (EBS)
- EBS Provide Block Level Storage
- EBS Volume and EC2 Instance, both should be in same availability zone (AZ).
- Can Attach single (one) EBS Volume to only one Instance at a same time.
- EBS Volumes are persistent (When we attach EBS Volume to a Instance, and you stop/delete the Instance then EBS Volume remains same...)

### Types of Volume
- Root Volume
- EBS Volume (Extra Volume)

### Types of EBS Volume
- Solid State Drive
- Hard Disk Drive
- Magnetic Standard
    - 1GB to 1TB
    - Charges are very low
    - Much Slower
    - Out-dated
    - Used for small scale operations

### IOPS (Input Output Operations per Second)
- Used to measure input output operations
- Less Input-Output Operations -> Use HDD
- High Input-Output Operations -> Use SSD

### Throughput
- How fast the data is moving from the system
- Used HDD for high Throughput
- eg. Animations

#### Types of SSD
1. General Purpose SSD
    - It is default EBS voulme type for EC2 instance.
    - offer a balance of price and performance for a variety of workloads.
    - It can be of two types:
        a. GP2
            - Highly recomended as boot volumes for EC2.
            - can be range in 1 GiB to 16 TiB
        b. GP3 (Default)
            - Default EBS volume types for EC2.
            - The most recent generation of SSD general purpose volumes are referred to as gp3 volumes.
            - At a cheaper cost than gp2.
    
2. Provisioned IOPS SSD
    - Designed to meet High IOPS
    - It can be of three types:
        a. IO1
        b. IO2
        c. IO2 Block Express

#### Types of HDD
1. Throughput Optimized HDD (st1)
    - Used for frequently accessible data)
2. Cold HDD (sc1)
    - Used for less frequently accessible data

#### Types of Storage
1. Block Storage 
    - EBS (Elastic Block Store)
    - It is a storage for EC2 Instance
2. File Storage
    - EFS
    - Similar to Linux, Windows File System [Hierarchical, eg. C:/User/..., /home/Desktop/...]
3. Object Storage
    - S3
    - Google Drive

### Snapshots
- Snapshot = Point-in-time backup of an EBS volume
- Used with Amazon Elastic Block Store (EBS)
- Stored internally in Amazon Simple Storage Service (S3)
- First snapshot → Full backup
- Next snapshots → Incremental (only changes saved)